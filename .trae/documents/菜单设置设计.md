# 菜单设置模块设计文档
## 1. 架构概述
菜单设置模块采用前后端分离架构，前端负责菜单的展示和交互，后端提供RESTful API接口处理菜单数据的增删改查等操作。

## 2. 技术栈
- 前端技术：Vue3 + TypeScript + Vite + Vue Flow
- 后端技术：Spring Boot 3.3.5 + MyBatis
- 数据库：MySQL 8.0

## 3. 数据模型设计
### 3.1 菜单实体（Menu）
```java
public class Menu {
    private Long id;                 // 菜单ID
    private String menuName;         // 菜单名称
    private String menuType;         // 菜单类型（目录、菜单、按钮）
    private String icon;             // 菜单图标
    private String path;             // 菜单路径
    private Integer sort;            // 菜单排序
    private String status;           // 菜单状态（正常、停用）
    private String remark;           // 菜单备注
    private String permission;       // 菜单权限
    private Long parentId;           // 父菜单ID
    private String params;           // 菜单参数
    private String component;        // 菜单组件
    private String route;            // 菜单路由
    private Long tenantId;           // 租户ID
    private Date createTime;         // 创建时间
    private Date updateTime;         // 更新时间
    // Getters and Setters
}
```

### 3.2 数据库表结构
```sql
CREATE TABLE `sys_menu` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '菜单ID',
  `menu_name` varchar(20) NOT NULL COMMENT '菜单名称',
  `menu_type` varchar(10) NOT NULL COMMENT '菜单类型（目录、菜单、按钮）',
  `icon` varchar(20) DEFAULT NULL COMMENT '菜单图标',
  `path` varchar(20) DEFAULT NULL COMMENT '菜单路径',
  `sort` int DEFAULT '0' COMMENT '菜单排序',
  `status` varchar(10) DEFAULT NULL COMMENT '菜单状态（正常、停用）',
  `remark` varchar(20) DEFAULT NULL COMMENT '菜单备注',
  `permission` varchar(20) DEFAULT NULL COMMENT '菜单权限',
  `parent_id` bigint DEFAULT NULL COMMENT '父菜单ID',
  `params` varchar(20) DEFAULT NULL COMMENT '菜单参数',
  `component` varchar(20) DEFAULT NULL COMMENT '菜单组件',
  `route` varchar(20) DEFAULT NULL COMMENT '菜单路由',
  `tenant_id` bigint NOT NULL COMMENT '租户ID',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `idx_tenant_id` (`tenant_id`),
  KEY `idx_parent_id` (`parent_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统菜单表';
```

## 4. API设计
### 4.1 查询菜单树
- **URL**: `/api/system/menu/tree`
- **Method**: GET
- **Request Param**: 
  - tenantId: 租户ID
- **Response**: 菜单树状结构数据

### 4.2 新增菜单
- **URL**: `/api/system/menu`
- **Method**: POST
- **Request Body**: 菜单实体对象
- **Response**: 操作结果

### 4.3 修改菜单
- **URL**: `/api/system/menu/{id}`
- **Method**: PUT
- **Request Body**: 菜单实体对象
- **Response**: 操作结果

### 4.4 删除菜单
- **URL**: `/api/system/menu/{id}`
- **Method**: DELETE
- **Response**: 操作结果

### 4.5 查询菜单详情
- **URL**: `/api/system/menu/{id}`
- **Method**: GET
- **Response**: 菜单详情

## 5. 业务逻辑设计
### 5.1 菜单树构建
- 根据父菜单ID递归构建菜单树状结构
- 支持按排序字段排序菜单节点

### 5.2 菜单校验逻辑
- 菜单名称唯一性校验
- 菜单路径唯一性校验
- 菜单权限唯一性校验
- 菜单参数校验（长度、格式等）

### 5.3 菜单删除逻辑
- 支持级联删除子菜单
- 删除前校验菜单是否被角色关联

## 6. 前端设计
- 使用Vue Tree组件展示菜单树状结构
- 提供菜单新增、修改、删除的表单界面
- 支持拖拽调整菜单顺序和层级
- 提供菜单权限配置界面

## 7. 安全性设计
- 所有接口都需要进行租户ID校验
- 所有接口都需要进行权限校验，只有管理员角色才能操作菜单

## 8. 性能优化
- 菜单数据缓存设计，减少数据库查询
- 分页查询大量菜单数据