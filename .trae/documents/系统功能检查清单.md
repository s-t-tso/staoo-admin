# 系统功能模块检查清单

根据system_requirements.md文件中的功能需求，对照当前项目代码结构和实现情况，整理如下功能模块检查清单：

## 一、已基本实现的功能模块

### 1. 租户管理
- **实现状态**：已实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/Tenant.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/TenantController.java`
  - 服务: `staoo-system/src/main/java/com/staoo/system/service/TenantService.java`
- **实现内容**：包含租户的基本CRUD操作，支持根据ID和租户名称查询租户信息

### 2. 菜单设置
- **实现状态**：已实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/Menu.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/MenuController.java`
- **实现内容**：支持菜单树状结构，包含菜单的基本属性和操作

### 3. 角色管理
- **实现状态**：已实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/Role.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/RoleController.java`
- **实现内容**：包含角色的基本CRUD操作

### 4. 用户管理
- **实现状态**：已实现基础功能
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/User.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/UserController.java`
- **实现内容**：包含用户的基本CRUD操作

### 5. 操作日志
- **实现状态**：已实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/OperationLog.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/OperationLogController.java`
  - 服务: `staoo-system/src/main/java/com/staoo/system/service/SystemOperationLogService.java`
- **实现内容**：记录用户操作，支持分页、排序、搜索和导出功能

### 6. 登录日志
- **实现状态**：已实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/LoginLog.java`
  - 服务: `staoo-system/src/main/java/com/staoo/system/service/LoginLogService.java`
- **实现内容**：记录用户登录信息，支持查询和清理功能

### 7. 系统通知
- **实现状态**：已实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/SystemNotice.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/SystemNoticeController.java`

### 8. 数据订阅
- **实现状态**：已实现基础功能
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/DataSubscription.java`
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/SubscriptionController.java`
- **实现内容**：支持第三方应用订阅数据变更通知

## 二、部分实现的功能模块

### 1. 登录功能
- **实现状态**：部分实现
- **文件位置**：
  - 配置: `staoo-api/src/main/resources/application.yml` 中的JWT配置
  - 事件监听器: `staoo-framework/src/main/java/com/staoo/framework/auth/listener/LoginEventListener.java`
- **缺失内容**：
  - 工号和密码登录的完整实现
  - 手机号验证码登录
  - 手机端二维码扫码登录
  - 登录重试次数限制和账号锁定机制
  - 拖动验证功能
  - 用户初始化密码和首次登录激活流程

### 2. 动态表单和流程、审核
- **实现状态**：部分实现
- **文件位置**：
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/FlowController.java`
  - 配置: `staoo-api/src/main/resources/application.yml` 中的Flowable配置
- **缺失内容**：
  - 动态表单配置功能
  - 可视化流程设计器
  - 工作台功能
  - 流程审批节点配置
  - 审批人和抄送人配置

### 3. 第三方应用登录
- **实现状态**：部分实现
- **文件位置**：
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/OAuthController.java`
- **缺失内容**：
  - 第三方应用信息配置管理
  - IAM登录和AUTH2.0登录的完整实现

### 4. 数据字典
- **实现状态**：部分实现
- **文件位置**：
  - 实体类: `staoo-system/src/main/java/com/staoo/system/domain/Dict.java`
- **缺失内容**：
  - 完整的CRUD操作
  - 分页、排序和搜索功能
  - 导出功能

### 5. 数据发放
- **实现状态**：部分实现
- **文件位置**：
  - 控制器: `staoo-system/src/main/java/com/staoo/system/controller/DataController.java`
- **缺失内容**：
  - 第三方应用获取部门组织架构接口
  - 第三方应用获取用户列表接口
  - 数据变更通知接口
  - 流程结果通知接口

## 三、未实现的功能模块

### 1. 系统监控
- **实现状态**：未实现
- **需求内容**：
  - 记录系统运行状态(CPU、内存、磁盘、网络等)
  - 支持分页、排序、搜索
  - 支持导出
  - 支持图表展示

### 2. 上传文件管理
- **实现状态**：未实现
- **文件位置**：
  - 配置: `staoo-api/src/main/resources/application.yml` 中的文件上传路径配置
- **需求内容**：
  - 文件存储管理(上传、下载、删除、查看)
  - 文件元数据管理
  - 文件权限管理
  - 文件版本管理
  - 文件搜索、分类、标签功能
  - 文件分享功能
  - 多存储位置支持(本地、云端)
  - 大文件切片上传

## 四、实现建议

### 1. 优先级高的实现任务

1. **完善登录功能**
   - 完成JWT认证流程
   - 实现账号锁定和解锁机制
   - 添加登录重试次数限制
   - 实现用户密码初始化和首次登录激活流程

2. **完善文件管理模块**
   - 创建文件实体类和数据库表
   - 实现文件上传、下载、删除基本功能
   - 支持本地文件存储

3. **完善数据发放功能**
   - 实现部门组织架构和用户列表数据接口
   - 完善数据变更通知机制
   - 实现流程结果通知接口

### 2. 具体实现计划

#### 登录功能完善
```java
// 实现登录服务
@Service
public class LoginServiceImpl implements LoginService {
    // 实现密码校验、验证码校验、账号锁定等逻辑
    // 生成和刷新JWT token
    // 记录登录日志
}

// 实现登录控制器
@RestController
@RequestMapping("/api/auth")
public class AuthController {
    // 实现工号密码登录接口
    // 实现手机号验证码登录接口
    // 实现token刷新接口
    // 实现登出接口
}
```

#### 文件管理模块实现
```java
// 文件实体类
public class FileInfo {
    private Long id;
    private String fileName;
    private String fileType;
    private Long fileSize;
    private String filePath;
    private String storageType; // 本地、阿里云、腾讯云等
    private String uploadUser;
    private LocalDateTime uploadTime;
    // getter和setter
}

// 文件控制器
@RestController
@RequestMapping("/api/file")
public class FileController {
    // 实现文件上传接口
    // 实现文件下载接口
    // 实现文件删除接口
    // 实现文件列表查询接口
}
```

#### 系统监控模块实现
```java
// 系统监控服务
@Service
public class SystemMonitorService {
    // 获取CPU使用率
    // 获取内存使用情况
    // 获取磁盘使用情况
    // 获取网络流量信息
    // 记录系统监控数据
}

// 系统监控控制器
@RestController
@RequestMapping("/api/monitor")
public class SystemMonitorController {
    // 实现系统状态查询接口
    // 实现监控数据统计接口
    // 实现监控数据导出接口
}
```